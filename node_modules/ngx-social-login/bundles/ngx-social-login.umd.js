(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('rxjs'), require('rxjs/operators')) :
    typeof define === 'function' && define.amd ? define('ngx-social-login', ['exports', '@angular/core', 'rxjs', 'rxjs/operators'], factory) :
    (factory((global['ngx-social-login'] = {}),global.ng.core,global.rxjs,global.rxjs.operators));
}(this, (function (exports,core,rxjs,operators) { 'use strict';

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var /** @type {?} */ CONFIG = new core.InjectionToken('providers configuration');

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
    /* global Reflect, Promise */
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b)
                if (b.hasOwnProperty(p))
                    d[p] = b[p]; };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function () {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s)
                    if (Object.prototype.hasOwnProperty.call(s, p))
                        t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /**
     * @abstract
     */
    var /**
     * @abstract
     */ OauthProvider = (function () {
        function OauthProvider(provider, src, onload, async) {
            if (async === void 0) {
                async = true;
            }
            this.ID_PREFIX = 'social-login__';
            var /** @type {?} */ id = this.ID_PREFIX + provider;
            if (document.getElementById(id)) {
                return;
            }
            var /** @type {?} */ script = document.createElement('script');
            script.id = id;
            script.async = async;
            script.src = src;
            script.onload = onload;
            script.defer = true;
            document.head.appendChild(script);
        }
        return OauthProvider;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /** @enum {string} */
    var Provider = {
        FACEBOOK: 'facebook',
        GOOGLE: 'google',
    };

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var FacebookProvider = (function (_super) {
        __extends(FacebookProvider, _super);
        function FacebookProvider(_config) {
            var _this = _super.call(this, Provider.FACEBOOK, '//connect.facebook.net/en_US/sdk.js', function () {
                var /** @type {?} */ initConfig = _this._config.initOptions;
                var /** @type {?} */ config = initConfig.version ? initConfig : __assign({}, initConfig, { version: 'v2.9' });
                FB.init(config);
            }) || this;
            _this._config = _config;
            return _this;
        }
        /**
         * @return {?}
         */
        FacebookProvider.prototype.login = /**
         * @return {?}
         */
            function () {
                var _this = this;
                return rxjs.Observable.create(function (observer) {
                    FB.login(function (response) {
                        if (response.authResponse) {
                            var /** @type {?} */ authResponse_1 = response.authResponse;
                            FB.api('/me?fields=name,email,picture,first_name,last_name', function (fbUser) {
                                observer.complete(/** @type {?} */ ({
                                    id: fbUser.id,
                                    name: fbUser.name,
                                    email: fbUser.email,
                                    profileImg: "https://graph.facebook.com/" + fbUser.id + "/picture?type=normal",
                                    firstName: fbUser.first_name,
                                    lastName: fbUser.last_name,
                                    accessToken: authResponse_1.accessToken
                                }));
                            });
                        }
                    }, _this._config.loginOptions);
                });
            };
        /**
         * @return {?}
         */
        FacebookProvider.prototype.logout = /**
         * @return {?}
         */
            function () {
                return rxjs.Observable.create(function (observer) { return observer.complete(FB.logout()); });
            };
        return FacebookProvider;
    }(OauthProvider));

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var GoogleProvider = (function (_super) {
        __extends(GoogleProvider, _super);
        function GoogleProvider(config) {
            var _this = _super.call(this, Provider.GOOGLE, '//apis.google.com/js/platform.js', function () {
                gapi.load('auth2', function () {
                    var /** @type {?} */ conf = !config.scope ? __assign({}, config, { scope: 'email' }) : config;
                    gapi.auth2
                        .init(conf)
                        .then(function (auth) { return (_this._googleAuth = auth); })
                        .catch(function (err) {
                        throw new Error("Something went wrong during initialization: " + err.details);
                    });
                });
            }) || this;
            return _this;
        }
        /**
         * @return {?}
         */
        GoogleProvider.prototype.login = /**
         * @return {?}
         */
            function () {
                var _this = this;
                return rxjs.from(this._googleAuth.signIn({ prompt: 'select_account' })).pipe(operators.map(function () {
                    var /** @type {?} */ profile = _this._googleAuth.currentUser.get().getBasicProfile();
                    var /** @type {?} */ accessToken = _this._googleAuth.currentUser.get().getAuthResponse(true).access_token;
                    var /** @type {?} */ idToken = _this._googleAuth.currentUser.get().getAuthResponse(true).id_token;
                    return {
                        id: profile.getId(),
                        email: profile.getEmail(),
                        name: profile.getName(),
                        profileImg: profile.getImageUrl(),
                        accessToken: accessToken,
                        idToken: idToken
                    };
                }));
            };
        /**
         * @return {?}
         */
        GoogleProvider.prototype.logout = /**
         * @return {?}
         */
            function () {
                var _this = this;
                return rxjs.Observable.create(function (observer) { return observer.complete(_this._googleAuth.signOut()); });
            };
        return GoogleProvider;
    }(OauthProvider));

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var SocialLoginService = (function () {
        function SocialLoginService(config) {
            var _this = this;
            this._providers = {};
            this._providers = Object.keys(config).reduce(function (obj, providerId) {
                var /** @type {?} */ provider = Provider[providerId.toUpperCase()];
                obj[provider] = _this.oauthProviderFactory(provider, config[providerId]);
                return obj;
            }, {});
        }
        /**
         * @param {?} provider
         * @return {?}
         */
        SocialLoginService.prototype.login = /**
         * @param {?} provider
         * @return {?}
         */
            function (provider) {
                this._providerInUse = provider;
                var /** @type {?} */ oauthProvider = this._providers[provider];
                return oauthProvider ? oauthProvider.login() : rxjs.EMPTY;
            };
        /**
         * @return {?}
         */
        SocialLoginService.prototype.logout = /**
         * @return {?}
         */
            function () {
                var /** @type {?} */ oauthProvider = this._providers[this._providerInUse];
                return oauthProvider ? oauthProvider.logout() : rxjs.EMPTY;
            };
        /**
         * @param {?} provider
         * @param {?} config
         * @return {?}
         */
        SocialLoginService.prototype.oauthProviderFactory = /**
         * @param {?} provider
         * @param {?} config
         * @return {?}
         */
            function (provider, config) {
                switch (provider) {
                    case Provider.FACEBOOK:
                        return new FacebookProvider(/** @type {?} */ (config));
                    case Provider.GOOGLE:
                        return new GoogleProvider(/** @type {?} */ (config));
                }
            };
        SocialLoginService.decorators = [
            { type: core.Injectable },
        ];
        /** @nocollapse */
        SocialLoginService.ctorParameters = function () {
            return [
                { type: undefined, decorators: [{ type: core.Inject, args: [CONFIG,] }] }
            ];
        };
        return SocialLoginService;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var NgxSocialLoginModule = (function () {
        function NgxSocialLoginModule() {
        }
        /**
         * @param {?} config
         * @return {?}
         */
        NgxSocialLoginModule.init = /**
         * @param {?} config
         * @return {?}
         */
            function (config) {
                return {
                    ngModule: NgxSocialLoginModule,
                    providers: [
                        { provide: CONFIG, useValue: config }
                    ]
                };
            };
        NgxSocialLoginModule.decorators = [
            { type: core.NgModule, args: [{
                        providers: [SocialLoginService]
                    },] },
        ];
        return NgxSocialLoginModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */

    exports.SocialLoginService = SocialLoginService;
    exports.NgxSocialLoginModule = NgxSocialLoginModule;
    exports.Provider = Provider;
    exports.Éµa = CONFIG;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXNvY2lhbC1sb2dpbi51bWQuanMubWFwIiwic291cmNlcyI6WyJuZzovL25neC1zb2NpYWwtbG9naW4vbGliL21vZGVscy9jb25maWctaW5qZWN0aW9uLXRva2VuLnRzIixudWxsLCJuZzovL25neC1zb2NpYWwtbG9naW4vbGliL3Byb3ZpZGVycy9vYXV0aC1wcm92aWRlci50cyIsIm5nOi8vbmd4LXNvY2lhbC1sb2dpbi9saWIvbW9kZWxzL3Byb3ZpZGVyLnRzIiwibmc6Ly9uZ3gtc29jaWFsLWxvZ2luL2xpYi9wcm92aWRlcnMvZmFjZWJvb2stcHJvdmlkZXIudHMiLCJuZzovL25neC1zb2NpYWwtbG9naW4vbGliL3Byb3ZpZGVycy9nb29nbGUtcHJvdmlkZXIudHMiLCJuZzovL25neC1zb2NpYWwtbG9naW4vbGliL3NlcnZpY2VzL3NvY2lhbC1sb2dpbi5zZXJ2aWNlLnRzIiwibmc6Ly9uZ3gtc29jaWFsLWxvZ2luL2xpYi9uZ3gtc29jaWFsLWxvZ2luLm1vZHVsZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0luamVjdGlvblRva2VufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7UHJvdmlkZXJDb25maWd9IGZyb20gJy4vY29uZmlnL3Byb3ZpZGVyLWNvbmZpZyc7XG5cbmV4cG9ydCBjb25zdCBDT05GSUc6IEluamVjdGlvblRva2VuPFByb3ZpZGVyQ29uZmlnPiA9IG5ldyBJbmplY3Rpb25Ub2tlbjxQcm92aWRlckNvbmZpZz4oJ3Byb3ZpZGVycyBjb25maWd1cmF0aW9uJyk7XG4iLCIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDApXHJcbiAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgZXhwb3J0cykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSByZXN1bHRba10gPSBtb2Rba107XHJcbiAgICByZXN1bHQuZGVmYXVsdCA9IG1vZDtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcbiIsImltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IFByb3ZpZGVyIH0gZnJvbSAnLi4vbW9kZWxzL3Byb3ZpZGVyJztcbmltcG9ydCB7IFNvY2lhbFVzZXIgfSBmcm9tICcuLi9tb2RlbHMvc29jaWFsLXVzZXInO1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgT2F1dGhQcm92aWRlciB7XG4gICAgcHJpdmF0ZSByZWFkb25seSBJRF9QUkVGSVggPSAnc29jaWFsLWxvZ2luX18nO1xuXG4gICAgY29uc3RydWN0b3IocHJvdmlkZXI6IFByb3ZpZGVyLCBzcmM6IHN0cmluZywgb25sb2FkOiAoKSA9PiB2b2lkLCBhc3luYyA9IHRydWUpIHtcbiAgICAgICAgY29uc3QgaWQgPSB0aGlzLklEX1BSRUZJWCArIHByb3ZpZGVyO1xuXG4gICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgICAgICBzY3JpcHQuaWQgPSBpZDtcbiAgICAgICAgc2NyaXB0LmFzeW5jID0gYXN5bmM7XG4gICAgICAgIHNjcmlwdC5zcmMgPSBzcmM7XG4gICAgICAgIHNjcmlwdC5vbmxvYWQgPSBvbmxvYWQ7XG4gICAgICAgIHNjcmlwdC5kZWZlciA9IHRydWU7XG4gICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcbiAgICB9XG5cbiAgICBhYnN0cmFjdCBsb2dpbigpOiBPYnNlcnZhYmxlPFNvY2lhbFVzZXI+O1xuXG4gICAgYWJzdHJhY3QgbG9nb3V0KCk6IE9ic2VydmFibGU8YW55Pjtcbn1cbiIsImV4cG9ydCBlbnVtIFByb3ZpZGVyIHtcbiAgICBGQUNFQk9PSyA9ICdmYWNlYm9vaycsXG4gICAgR09PR0xFID0gJ2dvb2dsZSdcbn1cbiIsImltcG9ydCB7IE9hdXRoUHJvdmlkZXIgfSBmcm9tICcuL29hdXRoLXByb3ZpZGVyJztcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IEZhY2Vib29rUHJvdmlkZXJDb25maWcgfSBmcm9tICcuLi9tb2RlbHMvY29uZmlnL2ZhY2Vib29rLXByb3ZpZGVyLWNvbmZpZyc7XG5pbXBvcnQgeyBTb2NpYWxVc2VyIH0gZnJvbSAnLi4vbW9kZWxzL3NvY2lhbC11c2VyJztcbmltcG9ydCB7IFByb3ZpZGVyIH0gZnJvbSAnLi4vbW9kZWxzL3Byb3ZpZGVyJztcblxuZGVjbGFyZSBjb25zdCBGQjogYW55O1xuXG5leHBvcnQgY2xhc3MgRmFjZWJvb2tQcm92aWRlciBleHRlbmRzIE9hdXRoUHJvdmlkZXIge1xuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgX2NvbmZpZzogRmFjZWJvb2tQcm92aWRlckNvbmZpZykge1xuICAgICAgICBzdXBlcihQcm92aWRlci5GQUNFQk9PSywgJy8vY29ubmVjdC5mYWNlYm9vay5uZXQvZW5fVVMvc2RrLmpzJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaW5pdENvbmZpZyA9IHRoaXMuX2NvbmZpZy5pbml0T3B0aW9ucztcbiAgICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IGluaXRDb25maWcudmVyc2lvbiA/IGluaXRDb25maWcgOiB7IC4uLmluaXRDb25maWcsIC4uLnsgdmVyc2lvbjogJ3YyLjknIH0gfTtcbiAgICAgICAgICAgIEZCLmluaXQoY29uZmlnKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgbG9naW4oKTogT2JzZXJ2YWJsZTxTb2NpYWxVc2VyPiB7XG4gICAgICAgIHJldHVybiBPYnNlcnZhYmxlLmNyZWF0ZShvYnNlcnZlciA9PiB7XG4gICAgICAgICAgICBGQi5sb2dpbigocmVzcG9uc2U6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5hdXRoUmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXV0aFJlc3BvbnNlID0gcmVzcG9uc2UuYXV0aFJlc3BvbnNlO1xuICAgICAgICAgICAgICAgICAgICBGQi5hcGkoJy9tZT9maWVsZHM9bmFtZSxlbWFpbCxwaWN0dXJlLGZpcnN0X25hbWUsbGFzdF9uYW1lJywgKGZiVXNlcjogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGZiVXNlci5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBmYlVzZXIubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWFpbDogZmJVc2VyLmVtYWlsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2ZpbGVJbWc6IGBodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8ke2ZiVXNlci5pZH0vcGljdHVyZT90eXBlPW5vcm1hbGAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3ROYW1lOiBmYlVzZXIuZmlyc3RfbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0TmFtZTogZmJVc2VyLmxhc3RfbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbjogYXV0aFJlc3BvbnNlLmFjY2Vzc1Rva2VuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGFzIFNvY2lhbFVzZXIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB0aGlzLl9jb25maWcubG9naW5PcHRpb25zKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgbG9nb3V0KCk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgICAgIHJldHVybiBPYnNlcnZhYmxlLmNyZWF0ZShvYnNlcnZlciA9PiBvYnNlcnZlci5jb21wbGV0ZShGQi5sb2dvdXQoKSkpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IE9ic2VydmFibGUsIGZyb20gfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IE9hdXRoUHJvdmlkZXIgfSBmcm9tICcuL29hdXRoLXByb3ZpZGVyJztcbmltcG9ydCB7IG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IEdvb2dsZVByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vbW9kZWxzL2NvbmZpZy9nb29nbGUtcHJvdmlkZXItY29uZmlnJztcbmltcG9ydCB7IFByb3ZpZGVyIH0gZnJvbSAnLi4vbW9kZWxzL3Byb3ZpZGVyJztcbmltcG9ydCB7IFNvY2lhbFVzZXIgfSBmcm9tICcuLi9tb2RlbHMvc29jaWFsLXVzZXInO1xuXG5kZWNsYXJlIGNvbnN0IGdhcGk6IGFueTtcblxuZXhwb3J0IGNsYXNzIEdvb2dsZVByb3ZpZGVyIGV4dGVuZHMgT2F1dGhQcm92aWRlciB7XG4gICAgcHJpdmF0ZSBfZ29vZ2xlQXV0aDogYW55O1xuXG4gICAgY29uc3RydWN0b3IoY29uZmlnOiBHb29nbGVQcm92aWRlckNvbmZpZykge1xuICAgICAgICBzdXBlcihQcm92aWRlci5HT09HTEUsICcvL2FwaXMuZ29vZ2xlLmNvbS9qcy9wbGF0Zm9ybS5qcycsICgpID0+IHtcbiAgICAgICAgICAgIGdhcGkubG9hZCgnYXV0aDInLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29uZiA9ICFjb25maWcuc2NvcGUgPyB7IC4uLmNvbmZpZywgLi4ueyBzY29wZTogJ2VtYWlsJyB9IH0gOiBjb25maWc7XG4gICAgICAgICAgICAgICAgZ2FwaS5hdXRoMlxuICAgICAgICAgICAgICAgICAgICAuaW5pdChjb25mKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihhdXRoID0+ICh0aGlzLl9nb29nbGVBdXRoID0gYXV0aCkpXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBTb21ldGhpbmcgd2VudCB3cm9uZyBkdXJpbmcgaW5pdGlhbGl6YXRpb246ICR7ZXJyLmRldGFpbHN9YCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGxvZ2luKCk6IE9ic2VydmFibGU8U29jaWFsVXNlcj4ge1xuICAgICAgICByZXR1cm4gZnJvbSh0aGlzLl9nb29nbGVBdXRoLnNpZ25Jbih7IHByb21wdDogJ3NlbGVjdF9hY2NvdW50JyB9KSkucGlwZShcbiAgICAgICAgICAgIG1hcCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJvZmlsZSA9IHRoaXMuX2dvb2dsZUF1dGguY3VycmVudFVzZXIuZ2V0KCkuZ2V0QmFzaWNQcm9maWxlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSB0aGlzLl9nb29nbGVBdXRoLmN1cnJlbnRVc2VyLmdldCgpLmdldEF1dGhSZXNwb25zZSh0cnVlKS5hY2Nlc3NfdG9rZW47XG4gICAgICAgICAgICAgICAgY29uc3QgaWRUb2tlbiA9IHRoaXMuX2dvb2dsZUF1dGguY3VycmVudFVzZXIuZ2V0KCkuZ2V0QXV0aFJlc3BvbnNlKHRydWUpLmlkX3Rva2VuO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHByb2ZpbGUuZ2V0SWQoKSxcbiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHByb2ZpbGUuZ2V0RW1haWwoKSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogcHJvZmlsZS5nZXROYW1lKCksXG4gICAgICAgICAgICAgICAgICAgIHByb2ZpbGVJbWc6IHByb2ZpbGUuZ2V0SW1hZ2VVcmwoKSxcbiAgICAgICAgICAgICAgICAgICAgYWNjZXNzVG9rZW46IGFjY2Vzc1Rva2VuLFxuICAgICAgICAgICAgICAgICAgICBpZFRva2VuOiBpZFRva2VuXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgbG9nb3V0KCk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgICAgIHJldHVybiBPYnNlcnZhYmxlLmNyZWF0ZShvYnNlcnZlciA9PiBvYnNlcnZlci5jb21wbGV0ZSh0aGlzLl9nb29nbGVBdXRoLnNpZ25PdXQoKSkpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEluamVjdCwgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgT2F1dGhQcm92aWRlciB9IGZyb20gJy4uL3Byb3ZpZGVycy9vYXV0aC1wcm92aWRlcic7XG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBFTVBUWSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgUHJvdmlkZXJDb25maWcgfSBmcm9tICcuLi9tb2RlbHMvY29uZmlnL3Byb3ZpZGVyLWNvbmZpZyc7XG5pbXBvcnQgeyBDT05GSUcgfSBmcm9tICcuLi9tb2RlbHMvY29uZmlnLWluamVjdGlvbi10b2tlbic7XG5pbXBvcnQgeyBGYWNlYm9va1Byb3ZpZGVyIH0gZnJvbSAnLi4vcHJvdmlkZXJzL2ZhY2Vib29rLXByb3ZpZGVyJztcbmltcG9ydCB7IEZhY2Vib29rUHJvdmlkZXJDb25maWcgfSBmcm9tICcuLi9tb2RlbHMvY29uZmlnL2ZhY2Vib29rLXByb3ZpZGVyLWNvbmZpZyc7XG5pbXBvcnQgeyBHb29nbGVQcm92aWRlckNvbmZpZyB9IGZyb20gJy4uL21vZGVscy9jb25maWcvZ29vZ2xlLXByb3ZpZGVyLWNvbmZpZyc7XG5pbXBvcnQgeyBHb29nbGVQcm92aWRlciB9IGZyb20gJy4uL3Byb3ZpZGVycy9nb29nbGUtcHJvdmlkZXInO1xuaW1wb3J0IHsgUHJvdmlkZXIgfSBmcm9tICcuLi9tb2RlbHMvcHJvdmlkZXInO1xuaW1wb3J0IHsgU29jaWFsVXNlciB9IGZyb20gJy4uL21vZGVscy9zb2NpYWwtdXNlcic7XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBTb2NpYWxMb2dpblNlcnZpY2Uge1xuICAgIHByaXZhdGUgcmVhZG9ubHkgX3Byb3ZpZGVyczogeyBbcHJvdmlkZXJJZDogc3RyaW5nXTogT2F1dGhQcm92aWRlciB9ID0ge307XG5cbiAgICBwcml2YXRlIF9wcm92aWRlckluVXNlOiBQcm92aWRlcjtcblxuICAgIGNvbnN0cnVjdG9yKEBJbmplY3QoQ09ORklHKSBjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG4gICAgICAgIHRoaXMuX3Byb3ZpZGVycyA9IE9iamVjdC5rZXlzKGNvbmZpZykucmVkdWNlKChvYmosIHByb3ZpZGVySWQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHByb3ZpZGVyID0gUHJvdmlkZXJbcHJvdmlkZXJJZC50b1VwcGVyQ2FzZSgpXTtcbiAgICAgICAgICAgIG9ialtwcm92aWRlcl0gPSB0aGlzLm9hdXRoUHJvdmlkZXJGYWN0b3J5KHByb3ZpZGVyLCBjb25maWdbcHJvdmlkZXJJZF0pO1xuICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgfSwge30pO1xuICAgIH1cblxuICAgIGxvZ2luKHByb3ZpZGVyOiBQcm92aWRlcik6IE9ic2VydmFibGU8U29jaWFsVXNlcj4ge1xuICAgICAgICB0aGlzLl9wcm92aWRlckluVXNlID0gcHJvdmlkZXI7XG4gICAgICAgIGNvbnN0IG9hdXRoUHJvdmlkZXIgPSB0aGlzLl9wcm92aWRlcnNbcHJvdmlkZXJdO1xuICAgICAgICByZXR1cm4gb2F1dGhQcm92aWRlciA/IG9hdXRoUHJvdmlkZXIubG9naW4oKSA6IEVNUFRZO1xuICAgIH1cblxuICAgIGxvZ291dCgpOiBPYnNlcnZhYmxlPFNvY2lhbFVzZXI+IHtcbiAgICAgICAgY29uc3Qgb2F1dGhQcm92aWRlciA9IHRoaXMuX3Byb3ZpZGVyc1t0aGlzLl9wcm92aWRlckluVXNlXTtcbiAgICAgICAgcmV0dXJuIG9hdXRoUHJvdmlkZXIgPyBvYXV0aFByb3ZpZGVyLmxvZ291dCgpIDogRU1QVFk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvYXV0aFByb3ZpZGVyRmFjdG9yeShcbiAgICAgICAgcHJvdmlkZXI6IFByb3ZpZGVyLFxuICAgICAgICBjb25maWc6IEdvb2dsZVByb3ZpZGVyQ29uZmlnIHwgRmFjZWJvb2tQcm92aWRlckNvbmZpZ1xuICAgICk6IE9hdXRoUHJvdmlkZXIge1xuICAgICAgICBzd2l0Y2ggKHByb3ZpZGVyKSB7XG4gICAgICAgICAgICBjYXNlIFByb3ZpZGVyLkZBQ0VCT09LOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRmFjZWJvb2tQcm92aWRlcihjb25maWcgYXMgRmFjZWJvb2tQcm92aWRlckNvbmZpZyk7XG4gICAgICAgICAgICBjYXNlIFByb3ZpZGVyLkdPT0dMRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEdvb2dsZVByb3ZpZGVyKGNvbmZpZyBhcyBHb29nbGVQcm92aWRlckNvbmZpZyk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQge01vZHVsZVdpdGhQcm92aWRlcnMsIE5nTW9kdWxlfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7U29jaWFsTG9naW5TZXJ2aWNlfSBmcm9tICcuL3NlcnZpY2VzL3NvY2lhbC1sb2dpbi5zZXJ2aWNlJztcbmltcG9ydCB7UHJvdmlkZXJDb25maWd9IGZyb20gJy4vbW9kZWxzL2NvbmZpZy9wcm92aWRlci1jb25maWcnO1xuaW1wb3J0IHtDT05GSUd9IGZyb20gJy4vbW9kZWxzL2NvbmZpZy1pbmplY3Rpb24tdG9rZW4nO1xuXG5ATmdNb2R1bGUoe1xuICAgIHByb3ZpZGVyczogW1NvY2lhbExvZ2luU2VydmljZV1cbn0pXG5leHBvcnQgY2xhc3MgTmd4U29jaWFsTG9naW5Nb2R1bGUge1xuXG4gICAgc3RhdGljIGluaXQoY29uZmlnOiBQcm92aWRlckNvbmZpZyk6IE1vZHVsZVdpdGhQcm92aWRlcnMge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmdNb2R1bGU6IE5neFNvY2lhbExvZ2luTW9kdWxlLFxuICAgICAgICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgICAgICAgICAge3Byb3ZpZGU6IENPTkZJRywgdXNlVmFsdWU6IGNvbmZpZ31cbiAgICAgICAgICAgIF1cbiAgICAgICAgfTtcbiAgICB9XG59XG4iXSwibmFtZXMiOlsiSW5qZWN0aW9uVG9rZW4iLCJ0c2xpYl8xLl9fZXh0ZW5kcyIsIk9ic2VydmFibGUiLCJmcm9tIiwibWFwIiwiRU1QVFkiLCJJbmplY3RhYmxlIiwiSW5qZWN0IiwiTmdNb2R1bGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQSx5QkFHYSxNQUFNLEdBQW1DLElBQUlBLG1CQUFjLENBQWlCLHlCQUF5QixDQUFDOztJQ0huSDs7Ozs7Ozs7Ozs7Ozs7SUFjQTtJQUVBLElBQUksYUFBYSxHQUFHLFVBQVMsQ0FBQyxFQUFFLENBQUM7UUFDN0IsYUFBYSxHQUFHLE1BQU0sQ0FBQyxjQUFjO2FBQ2hDLEVBQUUsU0FBUyxFQUFFLEVBQUUsRUFBRSxZQUFZLEtBQUssSUFBSSxVQUFVLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDO1lBQzVFLFVBQVUsQ0FBQyxFQUFFLENBQUMsSUFBSSxLQUFLLElBQUksQ0FBQyxJQUFJLENBQUM7Z0JBQUUsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQztvQkFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcs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